--Main
repeat wait() until game:IsLoaded() and game.Players.LocalPlayer

getgenv().Key = "caa72c81673275da083638d9"
local validKeys = {
    ["caa72c81673275da083638d9"] = true,
}

local player = game.Players.LocalPlayer
task.wait(1)

if not validKeys[getgenv().Key] then
    player:Kick("Key sai?. B·∫°n ƒë√£ b·ªã lo·∫°i.")
    return
end

game.StarterGui:SetCore("SendNotification", {
    Title = "KimSoi Hub",
    Text = "ƒê√£ T·∫£i Xong",
    Duration = 10,
    Icon = "rbxassetid://138706932256796"
})

task.wait(1.5)

local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

local Window = Fluent:CreateWindow({
    Title = "KimSoi Hub",
    SubTitle = "By KimSoi",
    TabWidth = 160,
    Size = UDim2.fromOffset(540, 450),
    Acrylic = true,
    Theme = "Default",
    MinimizeKey = Enum.KeyCode.LeftControl
})

SaveManager:LoadAutoloadConfig()

-- Toggle Icon (n√∫t tr√≤n tr·∫Øng gi·ªëng ·∫£nh)
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local ImageLabel = Instance.new("ImageLabel")
local UICorner = Instance.new("UICorner")
local TextButton = Instance.new("TextButton")

ScreenGui.Parent = game:GetService("CoreGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

Frame.Parent = ScreenGui
Frame.AnchorPoint = Vector2.new(0.1, 0.1)
Frame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Frame.Position = UDim2.new(0, 20, 0.1, -6)
Frame.Size = UDim2.new(0, 50, 0, 50)
Frame.Name = "ToggleIcon"
UICorner.CornerRadius = UDim.new(1, 0)
UICorner.Parent = Frame

ImageLabel.Parent = Frame
ImageLabel.Name = "Icon"
ImageLabel.AnchorPoint = Vector2.new(0.5, 0.5)
ImageLabel.Position = UDim2.new(0.5, 0, 0.5, 0)
ImageLabel.Size = UDim2.new(0, 60, 0, 60)
ImageLabel.BackgroundTransparency = 1
ImageLabel.Image = "rbxassetid://138706932256796"

TextButton.Name = "HotkeyButton"
TextButton.Parent = Frame
TextButton.Size = UDim2.new(1, 0, 1, 0)
TextButton.BackgroundTransparency = 1
TextButton.Text = ""

local VirtualInputManager = game:GetService("VirtualInputManager")
TextButton.MouseButton1Down:Connect(function()
    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.LeftControl, false, game)
    task.wait(0.05)
    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.LeftControl, false, game)
end)

-- Tabs
local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "" }),
    Misc = Window:AddTab({ Title = "Misc", Icon = "" }),
    Sever = Window:AddTab({ Title = "Sever", Icon = "" }),
    Fruit = Window:AddTab({ Title = "Fruit", Icon = "" }),
    Player = Window:AddTab({ Title = "Player", Icon = "" })
}

-- üîò Auto Farm Toggle
local autoFarmEnabled = false
Tabs.Main:AddToggle("AutoFarmToggle", {
    Title = "Auto Farm",
    Default = false,
    Callback = function(value)
        autoFarmEnabled = value
        shared.autoFarm = value
        if value then
            loadstring(game:HttpGet("https://raw.githubusercontent.com/nhansamtinam/KangSimHub/refs/heads/main/AutoFarmSieuCapVjppro"))()
        end
    end
})

-- üîò Auto Boss Toggle
Tabs.Main:AddToggle("AutoBossToggle", {
    Title = "Auto Boss",
    Default = false,
    Callback = function(value)
        autoBossEnabled = value
        shared.autoBoss = value
        if value then
            loadstring(game:HttpGet("https://raw.githubusercontent.com/nhansamtinam/KangSimHub/refs/heads/main/Auto%20Boss%20For%20Main%20Script"))()
        end
    end
})

-- üîò Auto Check Mana Toggle
Tabs.Main:AddToggle("AutoCheckManaToggle", {
    Title = "Auto Check Mana",
    Default = false,
    Callback = function(value)
        autoCheckManaEnabled = value
        shared.autoCheckMana = value
        if value then
            loadstring(game:HttpGet("https://raw.githubusercontent.com/nhansamtinam/KangSimHub/refs/heads/main/AutoCheckManaForMainScript"))()
        end
    end
})

-- üî¢ Dropdown Ch·ªçn Slot (1 ƒë·∫øn 8)
local selectedSlot = 1 -- m·∫∑c ƒë·ªãnh
Tabs.Misc:AddDropdown("SlotSelector", {
    Title = "Ch·ªçn Slot Tr√°i √Åc Qu·ª∑",
    Values = { "1", "2", "3", "4", "5", "6", "7", "8" },
    Multi = false,
    Default = "1",
    Callback = function(value)
        selectedSlot = tonumber(value)
        print("ƒê√£ ch·ªçn slot: " .. selectedSlot)
    end
})

-- üîò N√∫t G·ª≠i L·ªánh SwitchSlot
Tabs.Misc:AddButton({
    Title = "Chuy·ªÉn ƒê·∫øn Slot ƒê√£ Ch·ªçn",
    Description = "G·ª≠i l·ªánh SwitchSlot v·ªõi slot ƒë√£ ch·ªçn",
    Callback = function()
        local args = {
            "FruitsHandler",
            "SwitchSlot",
            {
                Slot = selectedSlot
            }
        }
        game:GetService("ReplicatedStorage"):WaitForChild("Replicator"):InvokeServer(unpack(args))
        print("ƒê√£ g·ª≠i l·ªánh SwitchSlot ƒë·∫øn slot: " .. selectedSlot)
    end
})

-- üîò Toggle Boost FPS
local boostFPSEnabled = false
Tabs.Misc:AddToggle("BoostFPSToggle", {
    Title = "Whit Screen",
    Default = false,
    Callback = function(value)
        boostFPSEnabled = value
        local lighting = game:GetService("Lighting")
        local terrain = workspace.Terrain
        if boostFPSEnabled then
            -- Gi·∫£m ch·∫•t l∆∞·ª£ng ƒë·ªÉ tƒÉng FPS
            lighting.GlobalShadows = false
            lighting.FogEnd = 9e9
            lighting.Brightness = 1
            lighting.ClockTime = 14
            lighting.Ambient = Color3.new(0, 0, 0)
            lighting.OutdoorAmbient = Color3.new(0, 0, 0)
            terrain.WaterWaveSize = 0
            terrain.WaterWaveSpeed = 0
            terrain.WaterReflectance = 0
            terrain.WaterTransparency = 0
            game:GetService("RunService"):Set3dRenderingEnabled(false)
        else
            -- Kh√¥i ph·ª•c l·∫°i m·∫∑c ƒë·ªãnh
            lighting.GlobalShadows = true
            lighting.FogEnd = 100000
            lighting.Brightness = 2
            lighting.ClockTime = 14
            lighting.Ambient = Color3.fromRGB(128, 128, 128)
            lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
            terrain.WaterWaveSize = 1
            terrain.WaterWaveSpeed = 1
            terrain.WaterReflectance = 0.5
            terrain.WaterTransparency = 0.5
            game:GetService("RunService"):Set3dRenderingEnabled(true)
        end
    end
})
-- üîò N√∫t Boost FPS
Tabs.Misc:AddButton({
    Title = "Boost FPS",
    Description = "Gi·∫£m ƒê·ªì H·ªça",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/nhansamtinam/BoostFPS/refs/heads/main/BoostFPS"))()
    end
})
--Auto Redeem Code
Tabs.Misc:AddButton({
    Title = "Redeem All Code",
    Description = "Redeem All Code",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/nhansamtinam/KangSimHub/refs/heads/main/Auto%20Redeem%20Code"))()
    end
})
-- üîò Ch·ªçn Map ƒë·ªÉ Teleport
local selectedMapId = 9224601490 -- M·∫∑c ƒë·ªãnh Dressrosa

Tabs.Sever:AddDropdown("MapSelector", {
    Title = "Ch·ªçn Map",
    Values = { "Dressrosa", "Wano", "Whole Cake", "Ranked Map" },
    Multi = false,
    Default = "Dressrosa",
    Callback = function(value)
        local mapIds = {
            ["Dressrosa"] = 9224601490,
            ["Wano"] = 12413901502,
            ["Whole Cake"] = 16190471004,
            ["Ranked Map"] = 17493355683
        }
        selectedMapId = mapIds[value]
        print("ƒê√£ ch·ªçn map: " .. value .. " (PlaceId: " .. selectedMapId .. ")")
    end
})
-- üîò N√∫t Teleport ƒë·∫øn Map ƒë√£ ch·ªçn
Tabs.Sever:AddButton({
    Title = "Teleport ƒê·∫øn Map",
    Description = "D·ªãch chuy·ªÉn ƒë·∫øn map ƒë√£ ch·ªçn",
local rejoinDelay = 10800 -- m·∫∑c ƒë·ªãnh 3 ti·∫øng

local hourInput = 0
local minuteInput = 0
local secondInput = 0

-- Nh·∫≠p gi·ªù
Tabs.Sever:AddInput("HourInput", {
    Title = "Gi·ªù",
    Default = "0",
    Placeholder = "Nh·∫≠p s·ªë gi·ªù",
    Numeric = true,
    Callback = function(value)
        hourInput = tonumber(value) or 0
    end
})

-- Nh·∫≠p ph√∫t
Tabs.Sever:AddInput("MinuteInput", {
    Title = "Ph√∫t",
    Default = "0",
    Placeholder = "Nh·∫≠p s·ªë ph√∫t",
    Numeric = true,
    Callback = function(value)
        minuteInput = tonumber(value) or 0
    end
})

-- Nh·∫≠p gi√¢y
Tabs.Sever:AddInput("SecondInput", {
    Title = "Gi√¢y",
    Default = "0",
    Placeholder = "Nh·∫≠p s·ªë gi√¢y",
    Numeric = true,
    Callback = function(value)
        secondInput = tonumber(value) or 0
    end
})
-- N√∫t x√°c nh·∫≠n v√† ch·∫°y auto rejoin
Tabs.Sever:AddButton({
    Title = "ƒê·∫∑t th·ªùi gian v√† b·∫≠t Auto Rejoin",
    Description = "T·ª± ƒë·ªông v√†o l·∫°i sau th·ªùi gian ƒë·∫∑t",
    Callback = function()
        rejoinDelay = (hourInput * 3600) + (minuteInput * 60) + secondInput

        game.StarterGui:SetCore("SendNotification", {
            Title = "Auto Rejoin",
            Text = "S·∫Ω t·ª± rejoin sau " .. rejoinDelay .. " gi√¢y",
            Duration = 8,
            Icon = "rbxassetid://138706932256796"
        })

        -- B·∫Øt ƒë·∫ßu v√≤ng l·∫∑p rejoin
        task.spawn(function()
            while true do
                task.wait(rejoinDelay)
                game:GetService("TeleportService"):Teleport(game.PlaceId, game.Players.LocalPlayer)
            end
        end)
    end
})
